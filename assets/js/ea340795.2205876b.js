"use strict";(self.webpackChunkrevyos_docs_new=self.webpackChunkrevyos_docs_new||[]).push([[8077],{5642:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>a,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"build/other/manuel_build_kernel","title":"\u624b\u52a8\u7f16\u8bd1\u5185\u6838","description":"\u5185\u6838\u5de5\u5177\u94fe\u4e0b\u8f7d\u5730\u5740\uff1a","source":"@site/docs/build/other/manuel_build_kernel.md","sourceDirName":"build/other","slug":"/build/other/manuel_build_kernel","permalink":"/revyos-docs-new/docs/build/other/manuel_build_kernel","draft":false,"unlisted":false,"editUrl":"https://github.com/kagura114/revyos-docs-new/tree/main/docs/build/other/manuel_build_kernel.md","tags":[],"version":"current","frontMatter":{},"sidebar":"documentSidebar","previous":{"title":"gcc build programs \u8bf4\u660e","permalink":"/revyos-docs-new/docs/build/other/gcc\u7f16\u8bd1\u8f6f\u4ef6\u8bf4\u660e"},"next":{"title":"T-Head QEMU \u7f16\u8bd1\u6d41\u7a0b","permalink":"/revyos-docs-new/docs/build/other/thead-qemu\u7f16\u8bd1\u6d41\u7a0b"}}');var s=o(4848),t=o(8453);const c={},i="\u624b\u52a8\u7f16\u8bd1\u5185\u6838",d={},l=[];function u(e){const n={a:"a",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u624b\u52a8\u7f16\u8bd1\u5185\u6838",children:"\u624b\u52a8\u7f16\u8bd1\u5185\u6838"})}),"\n",(0,s.jsx)(n.p,{children:"\u5185\u6838\u5de5\u5177\u94fe\u4e0b\u8f7d\u5730\u5740\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://occ-oss-prod.oss-cn-hangzhou.aliyuncs.com/resource//1663142514282/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1-20220906.tar.gz",children:"https://occ-oss-prod.oss-cn-hangzhou.aliyuncs.com/resource//1663142514282/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1-20220906.tar.gz"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u91cc\u5047\u8bbe\u7f16\u8bd1\u73af\u5883\u4e3a ",(0,s.jsx)(n.code,{children:"Ubuntu"})," \u6216 ",(0,s.jsx)(n.code,{children:"Debian"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5b89\u88c5\u4f9d\u8d56\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo apt install -y gdisk dosfstools g++-12-riscv64-linux-gnu build-essential libncurses-dev gawk flex bison openssl libssl-dev tree dkms libelf-dev libudev-dev libpci-dev libiberty-dev autoconf device-tree-compiler\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u89e3\u538b\u5de5\u5177\u94fe\uff08\u8fd9\u91cc\u89e3\u538b\u5230/opt\uff09\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"tar -xvf Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1-20220906.tar.gz -C /opt\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u5c06\u5de5\u5177\u94fe\u52a0\u5165\u73af\u5883\u53d8\u91cf\u4e2d\uff08\u5047\u8bbe\u5de5\u5177\u94fe\u653e\u5728/opt\u4e2d\uff09\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'export PATH="/opt/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.1/bin:$PATH"\nexport CROSS_COMPILE=riscv64-unknown-linux-gnu-\nexport ARCH=riscv\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u4f7f\u7528git\u4e0b\u8f7d\u5185\u6838\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"# \u5185\u6838\u4ed3\u5e93\ngit clone https://github.com/revyos/thead-kernel.git\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1\u5185\u6838\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"# \u521b\u5efa\u5b89\u88c5\u76ee\u6807\u76ee\u5f55\nmkdir rootfs && mkdir rootfs/boot\n\n# \u76ee\u5f55\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u76ee\u5f55\u7ed3\u6784\u5e94\u8be5\u770b\u8d77\u6765\u662f\u8fd9\u6837:\n# .. << \u5f53\u524d\u5de5\u4f5c\u8def\u5f84\n# |-- rootfs\n#     |-- boot\n# |-- thead-kernel\n#     |-- ...\n\n# \u8fdb\u5165\u5185\u6838\u4ee3\u7801\u76ee\u5f55\uff0c\u5f00\u59cb\u6784\u5efa\ncd thead-kernel\nmake CROSS_COMPILE=riscv64-unknown-linux-gnu- ARCH=riscv revyos_defconfig\nmake CROSS_COMPILE=riscv64-unknown-linux-gnu- ARCH=riscv -j$(nproc)\nmake CROSS_COMPILE=riscv64-unknown-linux-gnu- ARCH=riscv -j$(nproc) dtbs\nsudo make CROSS_COMPILE=riscv64-unknown-linux-gnu- ARCH=riscv INSTALL_MOD_PATH=../rootfs/ modules_install -j$(nproc)\nsudo make CROSS_COMPILE=riscv64-unknown-linux-gnu- ARCH=riscv INSTALL_PATH=../rootfs/boot zinstall -j$(nproc)\n# \u6784\u5efaperf\uff08\u5982\u679c\u9700\u8981\u7684\u8bdd\uff09\nmake CROSS_COMPILE=riscv64-unknown-linux-gnu- ARCH=riscv LDFLAGS=-static NO_LIBELF=1 NO_JVMTI=1 VF=1 -C tools/perf/\nsudo cp -v tools/perf/perf ../rootfs/sbin/perf-thead\n# \u5b89\u88c5\u5185\u6838\u5230\u5b89\u88c5\u76ee\u6807\u76ee\u5f55\nsudo cp -v arch/riscv/boot/Image ../rootfs/boot/\n# \u5b89\u88c5\u8bbe\u5907\u6811\u5230\u5b89\u88c5\u76ee\u6807\u76ee\u5f55\nsudo cp -v arch/riscv/boot/dts/thead/light-lpi4a.dtb ../rootfs/boot/\nsudo cp -v arch/riscv/boot/dts/thead/light-lpi4a-dsi0-hdmi.dtb ../rootfs/boot/\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e4b\u540e\u53ea\u9700\u8981\u628arootfs\u4e2d\u5185\u5bb9\u62f7\u8d1d\u6216\u8986\u76d6\u5230\u5bf9\u5e94\u76ee\u5f55\u5373\u53ef\uff0c\u6ce8\u610f\u5185\u6838Image\u548c\u5185\u6838module\u76ee\u5f55\u4e00\u5b9a\u8981\u5bf9\u5e94\uff0c\u4e0d\u7136\u4f1a\u56e0\u7f3a\u5931\u5185\u6838\u6a21\u5757\u5bfc\u81f4\u5916\u8bbe\u529f\u80fd\u5931\u6548\u3002"})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>i});var r=o(6540);const s={},t=r.createContext(s);function c(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);