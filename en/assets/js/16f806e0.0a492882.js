"use strict";(self.webpackChunkrevyos_docs_new=self.webpackChunkrevyos_docs_new||[]).push([[5709],{2189:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"build/debian/Debian\u8f6f\u4ef6\u5305\u6784\u5efa\u6d41\u7a0b","title":"Debian Package Build Process","description":"Host Debian","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/build/debian/Debian\u8f6f\u4ef6\u5305\u6784\u5efa\u6d41\u7a0b.md","sourceDirName":"build/debian","slug":"/build/debian/Debian\u8f6f\u4ef6\u5305\u6784\u5efa\u6d41\u7a0b","permalink":"/revyos-docs-new/en/docs/build/debian/Debian\u8f6f\u4ef6\u5305\u6784\u5efa\u6d41\u7a0b","draft":false,"unlisted":false,"editUrl":"https://github.com/kagura114/revyos-docs-new/tree/main/docs/build/debian/Debian\u8f6f\u4ef6\u5305\u6784\u5efa\u6d41\u7a0b.md","tags":[],"version":"current","frontMatter":{},"sidebar":"documentSidebar","previous":{"title":"RevyOS","permalink":"/revyos-docs-new/en/docs/intro"},"next":{"title":"Enable T-Head Optimization GCC","permalink":"/revyos-docs-new/en/docs/build/debian/enable_optimization_gcc"}}');var t=n(4848),i=n(8453);const o={},a="Debian Package Build Process",d={},c=[{value:"Host Debian",id:"host-debian",level:2},{value:"Creating the Packaging Environment",id:"creating-the-packaging-environment",level:2},{value:"revyos-c910v",id:"revyos-c910v",level:3},{value:"Build Command",id:"build-command",level:2},{value:"revyos-c910v",id:"revyos-c910v-1",level:3}];function u(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"debian-package-build-process",children:"Debian Package Build Process"})}),"\n",(0,t.jsx)(s.h2,{id:"host-debian",children:"Host Debian"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Compiling under qemu-user\nsudo apt update\nsudo apt install -y \\\n\tsbuild buildd qemu-system-misc qemu-user-static binfmt-support \\\n\tca-certificates apt-transport-https devscripts mmdebstrap\n\n# Native\nsudo apt install -y \\\n\tsbuild buildd ca-certificates apt-transport-https devscripts mmdebstrap\n\n# Fix debian-ports certificate issues on the host (may not be necessary at this stage)\nwget https://mirror.sjtu.edu.cn/debian/pool/main/d/debian-ports-archive-keyring/debian-ports-archive-keyring_2023.02.01_all.deb\nsudo dpkg -i ./debian-ports-archive-keyring_2023.02.01_all.deb\n\n# Add current user to sbuild without root\nsudo sbuild-adduser $USER\n"})}),"\n",(0,t.jsx)(s.h2,{id:"creating-the-packaging-environment",children:"Creating the Packaging Environment"}),"\n",(0,t.jsx)(s.h3,{id:"revyos-c910v",children:"revyos-c910v"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'export SUFFIX=revyos-c910v-sbuild\nsudo sbuild-createchroot --debootstrap=debootstrap --arch=riscv64 \\\n\t--chroot-suffix=-$SUFFIX \\\n\t--keyring=\'\' \\\n\t--no-deb-src \\\n\t--include=debian-ports-archive-keyring,ca-certificates,apt-transport-https,eatmydata \\\n\t--extra-repository="deb [trusted=yes] https://mirror.iscas.ac.cn/revyos/revyos-c910v/ revyos-c910v main contrib non-free" \\\n\t--extra-repository="deb [trusted=yes] https://mirror.iscas.ac.cn/revyos/revyos-addons/ revyos-addons main" \\\n\tsid /srv/chroot/sid-riscv64-$SUFFIX \\\n\thttps://mirror.iscas.ac.cn/revyos/revyos-base/\n\n# Fix environment-related issues\nsudo sed -i \'s/deb http/deb [trusted=yes] http/g\' /srv/chroot/sid-riscv64-$SUFFIX/etc/apt/sources.list\nsudo rm -rf /srv/chroot/sid-riscv64-$SUFFIX/var/lib/apt/lists/*\necho "command-prefix=eatmydata" | sudo tee -a /etc/schroot/chroot.d/sid-riscv64-$SUFFIX-*\n\n# Adjust source order - to use the c910v repository for the same version\n# Edit sources.list to ensure the following order\ndeb [trusted=yes] https://mirror.iscas.ac.cn/revyos/revyos-c910v/ revyos-c910v main contrib non-free\ndeb [trusted=yes] https://mirror.iscas.ac.cn/revyos/revyos-addons/ revyos-addons main\ndeb [trusted=yes] https://mirror.iscas.ac.cn/revyos/revyos-base/ sid main contrib non-free non-free-firmware\n'})}),"\n",(0,t.jsx)(s.h2,{id:"build-command",children:"Build Command"}),"\n",(0,t.jsx)(s.h3,{id:"revyos-c910v-1",children:"revyos-c910v"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"sbuild --arch=riscv64 -d sid -c sid-riscv64-revyos-c910v-sbuild xxx.dsc\n"})})]})}function l(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var r=n(6540);const t={},i=r.createContext(t);function o(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);